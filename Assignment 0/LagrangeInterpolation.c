#include <stdio.h>
#include <stdlib.h>

float LagrangeInterpolation(float *xx, float *yy, float x, int n)
{
    float y = 0;
    for (int i = 0; i <= n; i++)
    {
        float L = 1;
        for (int j = 0; j <= n; j++)
        {
            if (j != i)
            {
                L *= (x - xx[j]) / (xx[i] - xx[j]);
            }
        }
        y = y + (L * yy[i]);
    }
    return y;
}

int main(int argc, char **argv){

    FILE *fp;
    fp = fopen("output.txt", "w");

    int n = atoi(argv[1]);

    float x = 0;
    float y;

    float XX[9] = {0, 0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2};

    float YY_[9] = {0,0.7071,1,0.7071,0,-0.7071,-1,-0.7071,0};  // Without Noise

    // With Noise
    float YY[13][9] = {{0.01103, 0.70896, 1.01308, 0.7098, -0.00852, -0.72379, -0.99755, -0.70261, -0.02482}, 
                      {-0.00808, 0.70753, 1.0185, 0.71134, -0.04539, -0.67148, -0.97631, -0.72988, 0.02458}, 
                      {-0.0921, 0.65898, 1.06425, 0.72215, 0.00383, -0.69701, -0.95521, -0.69585, -0.00229}, 
                      {-0.08183, 0.76833, 1.15329, 0.85104, -0.10577, -0.75761, -1.05184, -0.65696, 0.05375}, 
                      {-0.161, 0.68953, 1.09173, 0.6998, 0.04693, -0.77427, -0.94688, -0.67449, -0.00837}, 
                      {-0.04726, 0.63093, 0.94299, 0.71851, -0.07922, -0.66192, -1.07215, -0.79165, -0.10241}, 
                      {-0.03242, 0.63609, 0.85385, 0.91307, 0.07279, -0.72668, -0.99176, -0.58298, -0.00915}, 
                      {-0.19784, 0.78295, 0.69731, 0.75705, 0.06449, -0.8716, -1.08521, -0.63618, 0.10885}, 
                      {-0.23937, 0.91803, 1.00461, 0.74814, -0.03641, -0.63152, -1.06413, -1.07897, -0.02667}, 
                      {-0.11378, 0.5526, 1.09932, 0.67119, -0.07199, -0.54042, -0.75369, -0.39501, 0.06418}, 
                      {0.2611, 0.39369, 1.4491, 0.49021, 0.05521, -0.72703, -1.45456, -0.81507, 0.01648}, 
                      {0.24351, 0.16964, 1.0124, 0.65668, 0.09484, -0.50825, -0.52067, -0.8203, -0.08046}, 
                      {-0.24927, 0.4439, 0.77349, 0.57061, 0.2347, -0.64885, -1.40196, -0.59035, 0.02562}};

    float *xx = XX;
    float *yy;
    if (n == 0)
    {
        yy = YY_;
    }
    else
    {
        yy = YY[n - 1];
    }

    for (int i = 0; i <= 100; i++)
    {
        y = LagrangeInterpolation(xx, yy, x, 8);    // n = 8
        fprintf(fp, "%f %f\n", x, y);
        x += 0.02;  // For 100 samples between 0 & 2
    }

    return 0;

}