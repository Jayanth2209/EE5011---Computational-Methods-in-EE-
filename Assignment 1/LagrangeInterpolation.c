#include <stdio.h>
#include <stdlib.h>

float LagrangeInterpolation(float *xx, float *yy, float x, int n)
{
    float y = 0;
    for (int i = 0; i <= n; i++)
    {
        float L = 1;
        for (int j = 0; j <= n; j++)
        {
            if (j != i)
            {
                L *= (x - xx[j]) / (xx[i] - xx[j]);
            }
        }
        y = y + (L * yy[i]);
    }
    return y;
}

int main(int argc, char **argv){

    FILE *fp;
    fp = fopen("output.txt", "w");

    int n = atoi(argv[1]);

    float x = 0;
    float y;

    float XX[9] = {0, 0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2};

    float YY[10][9] = {{0,0.7071,1,0.7071,0,-0.7071,-1,-0.7071,0}, 
                       {-0.01048, 0.70787, 1.00592, 0.71085, -0.00617, -0.71995, -1.00174, -0.69718, 0.01305}, 
                       {-0.003, 0.72769, 0.97209, 0.78227, -0.00177, -0.72414, -1.08522, -0.64964, -0.01714}, 
                       {0.00869, 0.66866, 0.91944, 0.65003, 0.02702, -0.73889, -1.02814, -0.73543, -0.04449}, 
                       {-0.00138, 0.77723, 0.98531, 0.54642, -0.05515, -0.82409, -1.0271, -0.72519, 0.14044}, 
                       {-0.02937, 0.69504, 0.97557, 0.71348, 0.03376, -0.71038, -0.79524, -0.40673, -0.0163}, 
                       {0.25841, 0.66864, 1.01397, 0.56834, -0.01084, -0.38825, -0.80644, -0.74455, -0.04703}, 
                       {-0.06702, 0.94271, 0.88434, 0.68416, 0.10914, -0.21478, -0.86522, -0.72162, 0.03105}, 
                       {-0.16773, 0.76505, 1.02452, 0.97997, 0.16669, -0.83766, -0.94324, -0.43677, -0.22653}, 
                       {-0.18281, 0.62219, 1.10747, 0.3884, -0.4498, -0.99702, -1.35692, -0.74982, 0.13947}};

    float *xx = XX;
    float *yy = YY[n];

    for (int i = 0; i < 100; i++)
    {
        y = LagrangeInterpolation(xx, yy, x, 8);
        fprintf(fp, "%f %f\n", x, y);
        x += 0.02;
    }

    return 0;

}