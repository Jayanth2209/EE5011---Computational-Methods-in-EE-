#include <stdio.h>
#include <stdlib.h>

float LagrangeInterpolation(float *xx, float *yy, float x, int n)
{
    float y = 0;
    for (int i = 0; i <= n; i++)
    {
        float L = 1;
        for (int j = 0; j <= n; j++)
        {
            if (j != i)
            {
                L *= (x - xx[j]) / (xx[i] - xx[j]);
            }
        }
        y = y + (L * yy[i]);
    }
    return y;
}

int main(int argc, char **argv){

    FILE *fp;
    fp = fopen("output.txt", "w");

    int n = atoi(argv[1]);

    float x = 0;
    float y;

    float XX[9] = {0, 0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2};

    float YY[10][9] = {{0,0.7071,1,0.7071,0,-0.7071,-1,-0.7071,0}, 
                       {-0.02206, 0.71354, 0.99346, 0.71198, -0.00954, -0.6982, -0.99673, -0.70219, -0.01508}, 
                       {0.01944, 0.75825, 1.00754, 0.77135, 0.05384, -0.67254, -0.9966, -0.69503, 0.03759},
                       {-0.11507, 0.83545, 0.97555, 0.68465, -0.00715, -0.66635, -1.04396, -0.65814, 0.00712},
                       {0.1938, 0.50944, 0.89726, 0.77082, -0.08206, -0.72333, -0.94461, -0.74636, -0.09955},
                       {0.06037, 0.65481, 1.14854, 0.75896, 0.01048, -0.61977, -0.97033, -0.83994, 0.03532},
                       {0.05111, 1.01566, 1.00231, 0.88301, -0.02892, -1.09703, -1.36942, -0.78833, -0.0261},
                       {-0.06472, 0.76869, 0.85506, 0.65371, -0.14466, -1.04075, -1.14295, -0.75746, -0.06177},
                       {-0.25177, 1.00601, 0.70864, 0.83891, 0.22867, -0.80184, -0.99284, -0.58832, 0.33082},
                       {-0.06915, 0.67984, 0.89208, 0.56868, -0.29636, -0.16593, -1.12335, -0.5828, 0.14741}};

    float *xx = XX;
    float *yy = YY[n];

    for (int i = 0; i < 100; i++)
    {
        y = LagrangeInterpolation(xx, yy, x, 8);
        fprintf(fp, "%f %f\n", x, y);
        x += 0.02;
    }

    return 0;

}